var AW_SKR=window.AW_SKR=window.AW_SKR||{};!function(e,t,a,o,n){"use strict";o.cache=function(){o.$={},o.$.html=a("html"),o.$.htmlbody=a("html, body"),o.$.skr=a("#skr"),o.$.form=a("#skr #skr-form"),o.$.floatinglabels=o.$.form.filter(".floating-labels"),o.$.formWrap=a("#skr .skr-input-wrap"),o.$.resultWrap=a("#skr .skr-result-wrap"),o.$.info=a("[data-info]"),o.$.error=a(".error-message",o.$.form),o.$.toValidate=a("[data-validation]",o.$.form),o.$.ux=a("[data-ux]",o.$.form)},o.timer=null,o.init=function(){void 0!==e.Joomla&&(o=a.extend(o,e.Joomla.getOptions("mod_aw_skr"),{isJoomla:!0})),o.cache(),o.$.skr.length&&(o.bodyJsClass(),o.$.floatinglabels.length&&o.floatLabels(),o.$.toValidate.length&&(o.$.toValidate.on("keypress",o.keypressFilter),o.$.form.on("submit",o.checkValidation),o.$.error.on("click",o.errorClose)),o.$.ux.length&&o.$.ux.filter('[data-ux="emptyOnZero"]').on("click focus blur focusout",o.uxEmptyOnZero),o.$.htmlbody.on("click",'a[href^="#"]',o.scrollTo),o.$.info.on("click",o.info),o.$.htmlbody.on("click",".js--AW_SKR-edit",o.closeResult),a(e).on("resize",o.resize).trigger("resize"))},o.load=function(){o.$.skr.length},o.resize=function(){o.$.skr.outerWidth()<320?o.$.skr.addClass("cond"):o.$.skr.removeClass("cond")},o.bodyJsClass=function(){o.$.html.hasClass("js")||o.$.html.hasClass("no-js")||o.$.html.addClass("no-js")},o.decodeHtml=function(e){var a=t.createElement("textarea");return a.innerHTML=e,a.value},o.scrollTo=function(e){var t="function"!=typeof e.preventDefault;t||e.preventDefault();var n=t?e.speed:1e3,r=100;t&&(r=e.distance?e.distance+r:r);var s=a(this).attr("href");if(t&&(s=e.target?e.target:s),"#"!==s){var i="object"==typeof s?s:a(s);i.length&&o.$.htmlbody.stop().animate({scrollTop:i.offset().top-r},n)}},o.info=function(e){var t=a(e.target),o=a("#"+t.attr("data-info"));o.slideDown(function(){o.on("click",".js--AW_SKR-infoclose",function(){o.slideUp()})})},o.showNotice=function(e){var t=a.extend({type:"info",message:"Info",target:".skr-result-wrap",autoclose:!0,autoclosetime:2e3,noclose:!1,scrollToTarget:!1},e),n=a("<div />").attr({class:"edit-notice notice-"+t.type}).html("<p>"+t.message+"</p>");a(t.target).append(n),t.scrollToTarget&&o.scrollTo({target:a(t.target)}),n.fadeIn(),!0!==t.noclose&&(n.one("click",function(){a(this).fadeOut(function(){a(this).remove()})}),!0===t.autoclose&&setTimeout(function(){n.trigger("click")},t.autoclosetime))},o.showResult=function(){o.scrollTo({target:o.$.form}),o.$.formWrap.slideUp(),o.$.resultWrap.slideDown()},o.closeResult=function(e){e.preventDefault(),o.scrollTo({target:o.$.form}),o.$.resultWrap.slideUp(),o.$.formWrap.slideDown()},o.convertJoomlaAjaxResponse=function(e){if(!o.isJoomla)return e;var t=e.data;return a.each(t,function(t,a){e[t]=a}),e},o.errorClose=function(e){clearTimeout(o.timer),a(e.currentTarget).slideUp("fast")},o.errorShow=function(e,t){t.html("<p>"+e+"</p>").slideDown(),o.timer=setTimeout(function(){t.slideUp(function(){t.empty()})},3e3)},o.floatLabels=function(){a(".skr-label",o.$.floatinglabels).next().each(function(){var e=a(this);o.floatLabelsCheckVal(e),e.on("change keyup focus blur",function(){o.floatLabelsCheckVal(e)})})},o.floatLabelsCheckVal=function(e){""!==e.val()||e.is(":focus")?e.prev(".skr-label").addClass("float"):e.prev(".skr-label").removeClass("float")},o.toggleHelpEhe=function(e){0===e.data["gw-mw-ehe"]?a(".js--AW_SKR-ehe-mv-notice").hide():a(".js--AW_SKR-ehe-mv-notice").show()},o.toggleHelpVersorgung=function(e){0===e.rawdata["skr-unter3"]&&0===e.rawdata["skr-ehevertrag"]?(a('[data-info="skr-info-versorgung"]').show(),a(".js--AW_SKR-versorgung-rversicherungen").show(),0===e.data["gw-mw-rvs"]?a(".js--AW_SKR-versorgung-mv-notice").hide():a(".js--AW_SKR-versorgung-mv-notice").show()):(a('[data-info="skr-info-versorgung"]').hide(),a("#skr-info-versorgung").hide())},o.keypressFilter=function(e){var t=a(this);t.find("input");switch(e.type){case"keypress":var o="number"==typeof e.which?e.which:e.keyCode;if(32>=o)return;var n=String.fromCharCode(o);if(t.is('[data-validation*="number"]')&&!new RegExp("^[0-9,]+$").test(n))return e.preventDefault(),!1}},o.uxEmptyOnZero=function(e){var t=a(this).find("input");switch(e.type){case"click":case"focus":"0"===t.val()&&t.val("");break;case"blur":case"focusout":""===t.val()&&t.val(0)}},o.checkValidation=function(e){function t(e){e.addClass("error"),u=u||e;var t=e.find("h4, .skr-label").text();"checkbox"===e.attr("data-validation-type")&&(t=e.parents("ul").siblings("h4").text(),e.siblings("li").length>1&&(t+=" "+e.find("label").text())),c.push(t)}function n(e){e.removeClass("error")}function r(e,t){var a;switch(t){case"email":a=/^[a-z0-9äöüß_\.\-]+@[-a-z0-9äöüß]{2,}[\.]+[0-9a-z]{2,6}$/i;break;case"url":a=/^(([a-zäöüß0-9\-])+[\.])+[a-zA-Z0-9]{2,4}$/i;break;case"password":a=/^[a-zäöüß0-9§(\x20-\x7E)]{3,50}[^\"\']$/i;break;case"number":a=/^[0-9,]{1,20}$/i;break;case"postcode":a=/^[0-9]{5}$/i;break;case"tags":a=/^[a-z0-9\-äöüß ]{1,300}$/i;break;case"min":a=/^.{3,}$/i;break;default:a=/^[a-zäöüß0-9§(\x20-\x7E)]{0,100}[^\"\']$/i}return!a||a.test(e)}void 0===e&&((e={}).preventDefault=function(){},e.type="check",e.target=o.$.form[0]);var s=a(e.target),i=a("[data-validation]",s),l=a(".error-message",s),c=[],u=null,d=null;if(i.on("keyup change focusout",function(){n(a(this))}).each(function(){d=a(this);var e=o.getValidationAtts(d),s=o.getValidationType(d),i=o.getValidationObject(d,s),l=!1;clearTimeout(o.timer),a.each(e,function(e,t){switch(s){case"input":case"textarea":case"select":"required"===t&&""===i.val()?l=!0:r(i.val(),t)||(l=!0);break;case"checkbox":"required"!==t||i.is(":checked")||(l=!0);break;case"radio":"required"!==t||i.length||(l=!0)}}),l?t(d):n(d)}),e.preventDefault(),u)o.errorShow("Bitte die benötigten Felder ausfüllen.",l),o.scrollTo({target:s}),u.not('[data-validation-type="radio"],[data-validation-type="checkbox"],[data-validation-type="select"]').find("input,textarea").filter(":first").trigger("focus");else{o.$.error.trigger("click");var f=o.isJoomla?Object.assign({},o.ajax_request):{action:"aw_skr_ajax",security:o.security};f=a.extend(f,{do:o.isJoomla?s.attr("data-action"):s.attr("action")});var p=s.serializeArray();a.each(p,function(e,t){var n=a("#"+t.name).parents("div");if(n.is("[data-validation]")){var r=o.getValidationAtts(n);1===a.inArray("number",r)&&(t.value=parseFloat(t.value.replace(",",".")))}f[t.name]=t.value});var h=o.isJoomla?{data:f}:{url:o.ajax_url,data:f};s[0]===o.$.form[0]&&(a("[data-skr-update]").addClass("updating"),o.$.form.find("button[type=submit]").addClass("updating"),a.post(h).done(function(e){void 0!==(e=o.convertJoomlaAjaxResponse(e)).success&&!1===e.success||(a("[data-skr-update]").each(function(){var t=a(this),n=t.attr("data-skr-update"),r=e.data[n];if("kontaktbutton"===n)return r=o.decodeHtml(r),void t.html(r);t.text(r)}),o.toggleHelpEhe(e),o.toggleHelpVersorgung(e),o.showResult())}).always(function(){a("[data-skr-update]").removeClass("updating"),o.$.form.find("button[type=submit]").removeClass("updating")}).fail(function(e,t,a){o.showNotice({type:"error",message:"Leider ist ein Fehler aufgetreten!",target:".skr-form-wrap"})}))}},o.getValidationAtts=function(e){var t=e.attr("data-validation");return""===t?["required"]:t=t.split("|")},o.getValidationType=function(e){var t=e.attr("data-validation-type");return""===t?"input":t},o.getValidationObject=function(e,t){var a;switch(t){case"input":a=e.find("input");break;case"select":a=e.find("select");break;case"radio":a=e.find("input[type=radio]:checked");break;case"checkbox":a=e.find("input[type=checkbox]");break;case"textarea":a=e.find("textarea")}return a},a(function(){o.init()}),a(e).on("load",function(){o.load()})}(window,document,jQuery,AW_SKR),function(e,t,a){function o(e,t){return typeof e===t}function n(){return"function"!=typeof t.createElement?t.createElement(arguments[0]):d?t.createElementNS.call(t,"http://www.w3.org/2000/svg",arguments[0]):t.createElement.apply(t,arguments)}function r(){var e=t.body;return e||((e=n(d?"svg":"body")).fake=!0),e}var s=[],i=[],l={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var a=this;setTimeout(function(){t(a[e])},0)},addTest:function(e,t,a){i.push({name:e,fn:t,options:a})},addAsyncTest:function(e){i.push({name:null,fn:e})}},c=function(){};c.prototype=l,c=new c;var u=t.documentElement,d="svg"===u.nodeName.toLowerCase(),f=l._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];l._prefixes=f;var p=l.testStyles=function(e,a,o,s){var i,l,c,d,f="modernizr",p=n("div"),h=r();if(parseInt(o,10))for(;o--;)(c=n("div")).id=s?s[o]:f+(o+1),p.appendChild(c);return i=n("style"),i.type="text/css",i.id="s"+f,(h.fake?h:p).appendChild(i),h.appendChild(p),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),p.id=f,h.fake&&(h.style.background="",h.style.overflow="hidden",d=u.style.overflow,u.style.overflow="hidden",u.appendChild(h)),l=a(p,e),h.fake?(h.parentNode.removeChild(h),u.style.overflow=d,u.offsetHeight):p.parentNode.removeChild(p),!!l};c.addTest("touch",function(){var a;if("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)a=!0;else{var o=["@media (",f.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");p(o,function(e){a=9===e.offsetTop})}return a}),c.addTest("js",function(){return!0}),function(){var e,t,a,n,r,l;for(var u in i)if(i.hasOwnProperty(u)){if(e=[],(t=i[u]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(a=0;a<t.options.aliases.length;a++)e.push(t.options.aliases[a].toLowerCase());for(n=o(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++)1===(l=e[r].split(".")).length?c[l[0]]=n:(!c[l[0]]||c[l[0]]instanceof Boolean||(c[l[0]]=Boolean(c[l[0]])),c[l[0]][l[1]]=n),s.push((n?"":"no-")+l.join("-"))}}(),function(e){var t=u.className,a=c._config.classPrefix||"";if(d&&(t=t.baseVal),c._config.enableJSClass){var o=new RegExp("(^|\\s)"+a+"no-js(\\s|$)");t=t.replace(o,"$1"+a+"js$2")}c._config.enableClasses&&(t+=" "+a+e.join(" "+a),d?u.className.baseVal=t:u.className=t)}(s),delete l.addTest,delete l.addAsyncTest;for(var h=0;h<c._q.length;h++)c._q[h]();e.Modernizr=c}(window,document);